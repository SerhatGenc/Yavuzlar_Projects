package apiconnect

import (
	"bufio"
	"fmt"
	"os"
	"strings"
)

func ApiSearch(result [3][]string, apiKey string) string {
	if result[0] != nil {

		return split(ConnectApi(result[0][0], apiKey))

	} else if result[1] != nil || result[2] != nil {
		fmt.Println("Can't find in html a content=Wordpress version but you can select a possible version of css and js search...")

		for {
			fmt.Println("Possible CSS search Wordpress versions = ", result[1])
			fmt.Println("Possible JS search Wordpress versions = ", result[2])
			fmt.Println("Select: ")
			input := bufio.NewReader(os.Stdin)
			chosen, _ := input.ReadString('\n')

			for i := 1; i < 3; i++ {

				for _, j := range result[i] {
					if j == chosen {

						return split(ConnectApi(result[0][0], apiKey))

					}
				}
			}

			fmt.Println("Please choose from the versions below")

		}

	} else {
		fmt.Println("No wordpress version found")
		return "Wordpress Not Found"
	}

}

func split(str string) string {
	str = str[1 : len(str)-1]
	index := strings.Index(str, "{")
	if index != -1 {
		str = str[index:]
	}
	return str

}
