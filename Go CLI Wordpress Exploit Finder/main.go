package main

import (
	"fmt"
	"os"
	a "wpExploit/ApiConnect"
	c "wpExploit/CLI_Options"
	p "wpExploit/Printer"
	w "wpExploit/Wordpress_Version"
)

func main() {
	link, apiKey := c.Flags()

	resArray := w.FindWordpressVer(*link)

	apiSearch := a.ApiSearch(resArray, *apiKey)

	if apiSearch == ` "status": "not found" ` {
		fmt.Println("Doesn't find any vulnerability")
		os.Exit(1)
	}
	result := a.MakeJson(apiSearch)
	p.Printer(result)

}
